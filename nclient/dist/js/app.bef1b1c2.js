(function(t){function e(e){for(var i,a,o=e[0],c=e[1],l=e[2],f=0,p=[];f<o.length;f++)a=o[f],r[a]&&p.push(r[a][0]),r[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(p.length)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(i=!1)}i&&(s.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},r={app:0},s=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"11ee":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("9e7b"),n("b260"),n("d64e");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"sidebar"},[n("h3",[t._v("P-Lyrics")]),n("ul",[n("a",[n("router-link",{staticClass:"nav-link",attrs:{tag:"li",to:"/"}},[t._v("Home")])],1),n("a",[n("router-link",{staticClass:"nav-link",attrs:{tag:"li",to:"/lyrics/new"}},[t._v("Add")])],1)])]),n("div",{staticClass:"main-content"},[n("router-view")],1)])},s=[],a={name:"app",components:{}},o=a,c=(n("5c0b"),n("b0a0"),n("2877")),l=Object(c["a"])(o,r,s,!1,null,null,null);l.options.__file="App.vue";var u=l.exports,f=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SearchPanel")},h=[],d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"frontpage-form"},[n("form",[n("fieldset",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.q,expression:"q"}],attrs:{type:"text",name:"q"},domProps:{value:t.q},on:{input:function(e){e.target.composing||(t.q=e.target.value)}}}),n("button",{staticClass:"pbutton pbutton-primary",attrs:{type:"submit"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.submit()}}},[n("i",{staticClass:"fas fa-search"}),t._v(" Search\n      ")])])])])},v=[],m={name:"SearchPanel",props:["prevQ"],data:function(){return{q:this.prevQ||""}},methods:{submit:function(){var t="/search",e=t+(""!==this.q?"?q=".concat(encodeURIComponent(this.q)):"");this.$router.push(e)}}},y=m,_=Object(c["a"])(y,d,v,!1,null,null,null);_.options.__file="SearchPanel.vue";var g=_.exports,b={name:"home",components:{SearchPanel:g}},w=b,P=Object(c["a"])(w,p,h,!1,null,null,null);P.options.__file="Home.vue";var L=P.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("LyricsViewer",{attrs:{sid:t.$route.params.sid}})},C=[],x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"lyrics-info"},[n("h3",[t._v(t._s(t.lyricsData.title))]),n("h4",[t._v(t._s(t.lyricsData.artist))])]),t._l(t.lyricsData.slyrics,function(e,i){return n("div",{key:i,staticClass:"line"},[t._l(e,function(e,r){return[t.validJapStr(e.sf)?n("span",{key:r,staticClass:"word",class:[{highlight:e.focus}],on:{click:function(n){t.focusWord(e,i)}}},[t._v(t._s(e.sf))]):n("span",{key:r},[t._v(t._s(e.sf))])]}),0===e.length?n("br"):t._e(),i===t.focusLine?n("DictPanel",{attrs:{word:t.highlightWord},on:{removePanel:t.removePanel}}):t._e()],2)})],2)},O=[],S=(n("0c34"),n("9d28"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dictBlock"},[n("div",{staticClass:"arrow-up",style:{left:t.arrowLeft+"px"}}),n("div",{staticClass:"lineBlock"},[n("div",{staticStyle:{width:"100%",float:"right","text-align":"right","border-bottom":"1px solid"},on:{click:t.removePanel}},[t._v("X")]),n("div",[t.meaning.japanese[0].word?n("div",[t._v("\n        "+t._s(t.meaning.japanese[0].word)+" ("+t._s(t.meaning.japanese[0].reading)+")\n      ")]):n("div",[t._v("\n        "+t._s(t.meaning.japanese[0].reading)+"\n      ")]),n("ul",t._l(t.meaning.senses,function(e,i){return n("li",{key:i},[t._v(t._s(e.definition))])}),0)])])])}),k=[],$={name:"DictPanel",props:["word"],data:function(){return{arrowLeft:this.calcArrowOffset(),meaning:{japanese:[{word:"",reading:""}],senses:[{definition:"",pos:""}]}}},computed:{},mounted:function(){this.arrowLeft=this.calcArrowOffset(),this.searchWord()},watch:{word:function(t,e){this.arrowLeft=this.calcArrowOffset(),this.searchWord()}},methods:{calcArrowOffset:function(){var t=document.querySelector(".highlight"),e=this.$el;if(void 0==t||void 0==e)return 500;var n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=5;return n.left-i.left-r+n.width/2},removePanel:function(){this.$emit("removePanel")},searchWord:function(){var t=this;fetch("".concat("http://192.168.1.197:8080","/api/jisho?keyword=").concat(this.word)).then(function(t){return t.json()}).then(function(e){t.meaning.japanese=e[0].japanese,t.meaning.senses=e[0].senses.map(function(t){return{definition:t["english_definitions"],pos:t["parts_of_speech"]}})}).catch()}}},q=$,D=Object(c["a"])(q,S,k,!1,null,null,null);D.options.__file="DictPanel.vue";var E=D.exports,A={name:"LyricsViewer",components:{DictPanel:E},props:{sid:String},data:function(){return{lyricsData:{title:"",artist:"",slyrics:[]},focusLine:void 0,highlightWord:""}},created:function(){var t=this;fetch("".concat("http://192.168.1.197:8080","/api/lyrics/").concat(this.sid)).then(function(t){return t.json()}).then(function(e){t.lyricsData=e})},methods:{focusWord:function(t,e){this.lyricsData.slyrics.forEach(function(t){t.forEach(function(t){delete t.focus})}),this.$set(t,"focus",!0),this.highlightWord=t.sf,this.focusLine=e},removePanel:function(){this.lyricsData.slyrics.forEach(function(t){t.forEach(function(t){delete t.focus})}),this.focusLine=void 0,this.highlightWord=""},validJapStr:function(t){var e=/[\(\)A-Za-z .?!'"？！―　“”「」…─0-9]/,n=t.match(e);return null===n}}},R=A,T=Object(c["a"])(R,x,O,!1,null,null,null);T.options.__file="LyricsViewer.vue";var I=T.exports,W={name:"lyrics",components:{LyricsViewer:I}},B=W,N=Object(c["a"])(B,j,C,!1,null,null,null);N.options.__file="Lyrics.vue";var U=N.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("SearchResult",{attrs:{q:t.$route.query.q}})},J=[],M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("SearchPanel",{attrs:{prevQ:t.q}}),t._l(t.lyricsData,function(e){return n("div",{key:e.sid,staticClass:"result-item",on:{click:function(n){t.getLyrics(e.sid)}}},[n("h3",[t._v(t._s(e.title))]),n("h5",[t._v(t._s(e.artist)+" ("+t._s(e.sid)+")")]),t._l(e.slyrics,function(e){return[n("span",[t._v(t._s(e))]),n("br")]}),n("hr")],2)}),0===t.lyricsData.length?n("div",[n("h3",[t._v("No result")])]):t._e()],2)},Q=[],H={name:"SearchResult",components:{SearchPanel:g},props:["q"],data:function(){return{lyricsData:[]}},computed:{},mounted:function(){this.updateLyrics()},watch:{q:function(){this.updateLyrics()}},methods:{getLyrics:function(t){this.$router.push("/lyrics/".concat(t))},updateLyrics:function(){var t=this,e="".concat("http://192.168.1.197:8080","/api/lyrics/search"),n=e+(this.q?"?q=".concat(encodeURIComponent(this.q)):"");fetch(n).then(function(t){return t.json()}).then(function(e){t.lyricsData=e})}}},z=H,F=Object(c["a"])(z,M,Q,!1,null,null,null);F.options.__file="SearchResult.vue";var X=F.exports,Z={name:"search",components:{SearchResult:X},data:function(){return{q:""}}},G=Z,K=Object(c["a"])(G,V,J,!1,null,null,null);K.options.__file="Search.vue";var Y=K.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("LyricsAddPanel")},et=[],nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"center"},[n("div",[n("form",{staticClass:"pform"},[n("fieldset",[n("legend",[t._v("Lyrics Form")]),n("div",{staticClass:"form-row"},[n("label",{attrs:{for:"title"}},[t._v("Title")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{id:"title",type:"text",placeholder:"Title"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),n("button",{staticClass:"pbutton pbutton-success",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.searchImportLyrics()}}},[n("i",{staticClass:"fas fa-plus-circle white-icon"})])]),t.importTitle?n("ImportLyricsPanel",{attrs:{title:t.importTitle},on:{importLyrics:t.importLyrics}}):t._e(),n("div",{staticClass:"form-row"},[n("label",{attrs:{for:"artist"}},[t._v("Artist")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.artist,expression:"artist"}],attrs:{id:"artist",type:"text",placeholder:"Artist"},domProps:{value:t.artist},on:{input:function(e){e.target.composing||(t.artist=e.target.value)}}})]),n("div",{staticClass:"form-row"},[n("label",{attrs:{for:"lyrics"}},[t._v("Lyrics")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.lyrics,expression:"lyrics"}],attrs:{id:"lyrics",rows:"30"},domProps:{value:t.lyrics},on:{input:function(e){e.target.composing||(t.lyrics=e.target.value)}}})]),n("div",{staticClass:"form-row"},[n("button",{staticClass:"pbutton pbutton-primary",attrs:{type:"submit"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.submit()}}},[t._v("Submit")])])],1)])])])},it=[],rt=n("7b76"),st=n.n(rt),at=(n("7bae"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-expand"},t._l(t.searchResult,function(e){return n("div",{key:e.lid,staticClass:"search-result",on:{click:function(n){t.importLyrics(e)}}},[n("h4",[t._v(t._s(e.name)+" - "+t._s(e.artist))]),n("h5",[t._v(t._s(e.content))])])}),0)}),ot=[],ct=(n("e30b"),{name:"ImportLyricsPanel",props:["title"],data:function(){return{searchResult:[]}},mounted:function(){this.searchLyricsOnline(this.title)},watch:{title:function(){this.searchLyricsOnline(this.title)}},methods:{searchLyricsOnline:function(t){var e=this;fetch("".concat("http://192.168.1.197:8080","/api/fetch/search/").concat(t)).then(function(t){return t.json()}).then(function(t){e.searchResult=t}).catch(console.log)},importLyrics:function(t){var e=this;fetch("".concat("http://192.168.1.197:8080","/api/fetch/lyrics?aid=").concat(encodeURIComponent(t.aid),"&lid=").concat(encodeURIComponent(t.lid))).then(function(t){return t.json()}).then(function(n){var i={title:t.name,artist:t.artist,content:n};e.$emit("importLyrics",i)}).catch(console.log)}}}),lt=ct,ut=Object(c["a"])(lt,at,ot,!1,null,null,null);ut.options.__file="ImportLyricsPanel.vue";var ft=ut.exports,pt={name:"SearchPanel",components:{ImportLyricsPanel:ft},data:function(){return{title:"",artist:"",lyrics:"",importTitle:""}},methods:{submit:function(){var t=this;if(""!==this.title&&""!==this.artist&&""!==this.lyrics){var e={title:this.title,artist:this.artist,slyrics:this.lyrics.split("\n")};fetch("${process.env.VUE_APP_DB_IP}/api/lyrics",{method:"POST",body:st()(e),headers:{"Content-Type":"application/json"}}).then(function(t){return t.json()}).then(function(e){var n=e["sid"];t.$router.push("/lyrics/".concat(n))}).catch(console.log)}},searchImportLyrics:function(){this.importTitle=this.title},importLyrics:function(t){this.title=t.title,this.artist=t.artist,this.lyrics=t.content.join("\n"),this.importTitle=""}}},ht=pt,dt=Object(c["a"])(ht,nt,it,!1,null,null,null);dt.options.__file="LyricsAddPanel.vue";var vt=dt.exports,mt={name:"lyrics-new",components:{LyricsAddPanel:vt},data:function(){return{}}},yt=mt,_t=Object(c["a"])(yt,tt,et,!1,null,null,null);_t.options.__file="LyricsAdd.vue";var gt=_t.exports;i["a"].use(f["a"]);var bt=new f["a"]({mode:"history",base:"/",routes:[{path:"/lyrics/new",name:"lyrics-new",component:gt},{path:"/lyrics/:sid(\\d+)",name:"lyrics",component:U},{path:"/",name:"",component:L},{path:"/search",name:"search",component:Y}]});i["a"].config.productionTip=!1,new i["a"]({router:bt,render:function(t){return t(u)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var i=n("11ee"),r=n.n(i);r.a},b0a0:function(t,e,n){"use strict";var i=n("df0c"),r=n.n(i);r.a},df0c:function(t,e,n){}});
//# sourceMappingURL=app.bef1b1c2.js.map